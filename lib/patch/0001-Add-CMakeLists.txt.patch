From 73434a01925efac55315378a18958ac20d7302f0 Mon Sep 17 00:00:00 2001
From: Dimitri Bouron <d.bouron@criteo.com>
Date: Tue, 22 Oct 2019 11:23:40 +0200
Subject: [PATCH] Add CMakeLists.txt

---
 CMakeLists.txt         | 36 ++++++++++++++++++++++++++++++++++++
 imagequant.pc.in.cmake | 11 +++++++++++
 2 files changed, 47 insertions(+)
 create mode 100644 CMakeLists.txt
 create mode 100644 imagequant.pc.in.cmake

diff --git a/CMakeLists.txt b/CMakeLists.txt
new file mode 100644
index 0000000..9ea9cca
--- /dev/null
+++ b/CMakeLists.txt
@@ -0,0 +1,36 @@
+cmake_minimum_required(VERSION 2.6)
+
+project(imagequant C)
+
+option(BUILD_SHARED_LIBS "Build shared libraries" OFF)
+option(BUILD_WITH_SSE "Use SSE" ON)
+
+if(BUILD_WITH_SSE)
+  add_definitions(-DUSE_SSE=1)
+endif()
+
+include_directories(${CMAKE_SOURCE_DIR})
+
+if(CMAKE_COMPILER_IS_GNUCC)
+  add_compile_options("-std=c99")
+endif()
+
+add_library(imagequant SHARED 
+  libimagequant.c
+  blur.c
+  mediancut.c
+  mempool.c
+  nearest.c
+  pam.c
+  kmeans.c)
+
+install(TARGETS imagequant
+  RUNTIME DESTINATION "${CMAKE_INSTALL_PREFIX}/bin"
+  LIBRARY DESTINATION "${CMAKE_INSTALL_PREFIX}/lib")
+
+install(FILES libimagequant.h
+  DESTINATION "${CMAKE_INSTALL_PREFIX}/include")
+
+configure_file("${CMAKE_SOURCE_DIR}/imagequant.pc.in.cmake"
+  "${CMAKE_INSTALL_PREFIX}/lib/pkgconfig/imagequant.pc"
+  @ONLY)
diff --git a/imagequant.pc.in.cmake b/imagequant.pc.in.cmake
new file mode 100644
index 0000000..233e4ba
--- /dev/null
+++ b/imagequant.pc.in.cmake
@@ -0,0 +1,11 @@
+prefix=@CMAKE_INSTALL_PREFIX@
+includedir=${prefix}/include
+libdir=${prefix}/lib
+bindir=${prefix}/bin
+
+Name: imagequant
+Description: Small, portable C library for high-quality conversion of RGBA images to 8-bit indexed-color (palette) images.
+URL: https://pngquant.org/lib/
+Version: VERSION
+Libs: -L${libdir} -L${bindir} -limagequant
+Cflags: -I${includedir}
-- 
2.17.1

